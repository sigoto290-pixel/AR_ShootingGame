using UnityEngine;
using UnityEngine.Events;
using UnityEngine.EventSystems;

public class WorldButton : MonoBehaviour, IPointerDownHandler, IPointerClickHandler,IPointerExitHandler
{
    [SerializeField] Collider[] _colliders;
    [SerializeField] UnityEvent _unityEvent;
    [SerializeField] SpriteRenderer _frontSprite;
    [SerializeField] Transform _buttonTr;
    [SerializeField] Color _downColor;
    

    private Color _startColor;
    private Vector3 _startPosition;
    private Vector3 _offset = new Vector3(0, -0.35f, 0);

    void Start()
    {
        _startColor = _frontSprite.color;
        _startPosition = _buttonTr.localPosition;
    }
    //ほかのボタンにより、この自作コンポーネントにアタッチされたゲームオブジェクトが有効化された時、リセットする処理
    void OnEnable()
    {
        SetUpState();
    }
    public void OnPointerDown(PointerEventData pointerEventData)
    {
        SetDownState();
    }

    public void OnPointerClick(PointerEventData pointerEventData)
    {
        SetUpState();
        _unityEvent.Invoke();
    }
    public void OnPointerExit(PointerEventData pointerEventData)
    {
        SetUpState();
    }
    private void SetDownState()
    {
        _frontSprite.color = _downColor;
        _buttonTr.localPosition = _startPosition + _offset;
    }

    private void SetUpState()
    {
        _frontSprite.color = _startColor;
        _buttonTr.localPosition = _startPosition;
    }
}
